<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êô∫ËÉΩÂÅ•Â∫∑Êï∞ÊçÆÂàÜÊûêÂπ≥Âè∞</title>
    
    <!-- Â§ñÈÉ®CSSÊ†∑Âºè -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bigscreen/main.css') }}">
    
    <!-- Â§ñÈÉ®JavaScriptÂ∫ì -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://webapi.amap.com/maps?v=2.0&key=d45f28e481665db5b1145a5aa989e68a&plugin=AMap.Scale,AMap.ToolBar,AMap.MapType"></script>
    <script src="https://webapi.amap.com/loca?v=2.0.0&key=d45f28e481665db5b1145a5aa989e68a"></script>
</head>
<body>
    <!-- Ê∑ªÂä†Ê†áÈ¢òÊ†è -->
    <div class="header-title">
        <div class="header-decoration left"></div>
        <h1>{{ BIGSCREEN_TITLE }}</h1>
        <div class="header-decoration right"></div>
    </div>

    <div class="container">
        <!-- Â∑¶‰æßÈù¢Êùø -->
        <div class="side-container">
            <div class="panel">
                <div class="panel-header">
                    <span>ÂÆûÊó∂ÁªüËÆ°</span>
                    <span class="stats-date" id="statsDate"></span>
                </div>
                <div class="panel-content">
                    <div class="stats-grid">
                        <div class="stat-card health-data">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-info">
                                <span class="stat-label">ÂÅ•Â∫∑Êï∞ÊçÆ</span>
                                <div class="stat-value-container">
                                    <span class="stat-value" id="healthDataCount">0</span>
                                    <span class="stat-unit">Êù°</span>
                                </div>
                                <div class="stat-trend" id="healthTrend">+0%</div>
                            </div>
                        </div>
                        
                        <div class="stat-card alert-data">
                            <div class="stat-icon">‚ö†Ô∏è</div>
                            <div class="stat-info">
                                <span class="stat-label">ÂæÖÂ§ÑÁêÜÂëäË≠¶</span>
                                <div class="stat-value-container">
                                    <span class="stat-value" id="pendingAlerts">0</span>
                                    <span class="stat-unit">Êù°</span>
                                </div>
                                <div class="stat-trend" id="alertTrend">+0%</div>
                            </div>
                        </div>
                        
                        <div class="stat-card device-data">
                            <div class="stat-icon">üì±</div>
                            <div class="stat-info">
                                <span class="stat-label">Ê¥ªË∑ÉËÆæÂ§á</span>
                                <div class="stat-value-container">
                                    <span class="stat-value" id="activeDevices">0</span>
                                    <span class="stat-unit">Âè∞</span>
                                </div>
                                <div class="stat-trend" id="deviceTrend">+0%</div>
                            </div>
                        </div>
                        
                        <div class="stat-card message-data">
                            <div class="stat-icon">üí¨</div>
                            <div class="stat-info">
                                <span class="stat-label">Êú™ËØªÊ∂àÊÅØ</span>
                                <div class="stat-value-container">
                                    <span class="stat-value" id="unreadMessages">0</span>
                                    <span class="stat-unit">Êù°</span>
                                </div>
                                <div class="stat-trend" id="messageTrend">+0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="system-status" id="systemStatus">
                        <div class="status-indicator normal" id="statusIndicator"></div>
                        <span class="status-text" id="statusText">Á≥ªÁªüÊ≠£Â∏∏</span>
                        <span class="health-score" id="systemHealthScore">100</span>
                    </div>
                </div>
            </div>
            
            <div class="panel personnel-management">
                <div class="panel-header">
                    <h3>‰∫∫ÂëòÁÆ°ÁêÜ</h3>
                </div>
                <div class="panel-content">
                    <!-- ÁªüËÆ°Ê¶ÇËßàÂç°Áâá -->
                    <div class="personnel-stats-overview">
                        <div class="personnel-stats-grid">
                            <div class="personnel-stat-item">
                                <div class="stat-value" id="totalUsers">0</div>
                                <div class="stat-label">ÊÄª‰∫∫Êï∞</div>
                            </div>
                            <div class="personnel-stat-item">
                                <div class="stat-value" id="totalBindDevices">0</div>
                                <div class="stat-label">Â∑≤ÁªëÂÆöËÆæÂ§á</div>
                            </div>
                            <div class="personnel-stat-item">
                                <div class="stat-value" id="onlineRate">0%</div>
                                <div class="stat-label">ÁªëÂÆöÁéá</div>
                            </div>
                        </div>
                        <div class="personnel-details-link" onclick="showPersonnelDetails()">ËØ¶ÊÉÖ ‚Üí</div>
                    </div>
                    
                    <!-- Âø´ÈÄüÁªüËÆ°Âç°Áâá -->
                    <div class="quick-stats-grid">
                        <div class="quick-stat-card" onclick="filterByDepartment()">
                            <div class="quick-stat-value" id="activeDeptCount">0</div>
                            <div class="quick-stat-label">Ê¥ªË∑ÉÈÉ®Èó®</div>
                        </div>
                        <div class="quick-stat-card" onclick="filterByOnlineStatus()">
                            <div class="quick-stat-value" id="onlineUsers">0</div>
                            <div class="quick-stat-label">Âú®Á∫ø‰∫∫Âëò</div>
                        </div>
                        <div class="quick-stat-card" onclick="filterByDeviceStatus()">
                            <div class="quick-stat-value" id="boundDevices">0</div>
                            <div class="quick-stat-label">ÁªëÂÆöËÆæÂ§á</div>
                        </div>
                        <div class="quick-stat-card" onclick="filterByAlertStatus()">
                            <div class="quick-stat-value" id="alertUsers">0</div>
                            <div class="quick-stat-label">ÂëäË≠¶‰∫∫Âëò</div>
                        </div>
                    </div>
                    
                    <!-- ÂõæË°®Âå∫Âüü -->
                    <div class="personnel-charts-container">
                        <div id="departmentDistribution" class="personnel-chart">
                            <div class="chart-title">ÈÉ®Èó®ÂàÜÂ∏É</div>
                        </div>
                        <div id="userStatusChart" class="personnel-chart">
                            <div class="chart-title">Âú®Á∫øÁä∂ÊÄÅ</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <span>ÂëäË≠¶‰ø°ÊÅØ</span>
                </div>
                <div class="panel-content">
                    <div id="alertList" class="chart-container"></div>
                </div>
            </div>
        </div>

        <!-- ‰∏≠Èó¥Âú∞ÂõæÂå∫Âüü -->
        <div class="middle-container">
            <!-- Âú∞ÂõæÂÆπÂô® -->
            <div class="map-container" id="map-container">
                <!-- Á≠õÈÄâÈù¢Êùø -->
                <div class="filter-panel" id="filterPanel">
                    <div class="filter-toggle" id="filterToggle" onclick="toggleFilterPanel()">üîç</div>
                    <div class="filter-content">
                        <div class="filter-header">
                            <span>‰∫∫ÂëòÁ≠õÈÄâ</span>
                        </div>
                        <div class="filter-container">
                            <input type="text" id="searchInput" class="filter-search" placeholder="üîç Ê®°Á≥äÊêúÁ¥¢Áî®Êà∑...">
                            <select id="deptSelect" class="filter-select">
                                <option value="">ÈÄâÊã©ÈÉ®Èó®</option>
                            </select>
                            <select id="userSelect" class="filter-select">
                                <option value="">ÈÄâÊã©Áî®Êà∑</option>
                            </select>
                        </div>
                    </div>
                </div>
                <!-- ‰øùÁïôÂéüÊúâÂú∞Âõæ‰ª£Á†Å -->
            </div>
            
            <!-- Ê∂àÊÅØÈù¢Êùø -->
            <div class="message-panel">
                <div class="panel-header">
                    <span>Ê∂àÊÅØ‰ø°ÊÅØ</span>
                    <span class="message-count" id="messageCount">0</span>
                </div>
                <!-- Ê∂àÊÅØÈù¢ÊùøÂÜÖÂÆπ -->
                <div class="message-panel-content">
                    <!-- Â∑¶‰æßÊ∂àÊÅØÂàóË°® -->
                    <div class="message-list-container">
                        <div class="message-list-title">ÊúÄÊñ∞Ê∂àÊÅØ</div>
                        <div class="message-list" id="messageList"></div>
                    </div>
                    
                    <!-- Âè≥‰æßÁªüËÆ°ÂõæË°® -->
                    <div class="message-stats-container">
                        <div class="message-stats-title">Ê∂àÊÅØÁªüËÆ°</div>
                        <div class="message-stats-chart">
                            <!-- Ê∂àÊÅØÁªüËÆ°Ê¶ÇËßà -->
                            <div class="message-stats-overview">
                                <div class="message-stat-item">
                                    <div class="message-stat-value" id="todayMessages">0</div>
                                    <div class="message-stat-label">‰ªäÊó•</div>
                                </div>
                                <div class="message-stat-item">
                                    <div class="message-stat-value" id="unreadMessages">0</div>
                                    <div class="message-stat-label">Êú™ËØª</div>
                                </div>
                                <div class="message-stat-item">
                                    <div class="message-stat-value" id="urgentMessages">0</div>
                                    <div class="message-stat-label">Á¥ßÊÄ•</div>
                                </div>
                            </div>
                            <!-- Ê∂àÊÅØÁ±ªÂûãÂàÜÂ∏ÉÂõæ -->
                            <div id="messageStatsChart" class="message-chart"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Âè≥‰æßÈù¢Êùø -->
        <div class="side-container">
            <div class="panel watch-management">
                <div class="panel-header">
                    <span>üì± ÊâãË°®ÁÆ°ÁêÜ</span>
                    <span class="label">ÊÄªÊï∞: <span class="number" id="totalWatchDevices">0</span></span>
                </div>
                <div class="panel-content">
                    <!-- ÂõæË°®Âå∫Âüü -->
                    <div id="statsChart" class="chart-container"></div>
                </div>
            </div>
            
            <div class="panel health-analysis">
                <div class="panel-header">
                    <span>üíó ÂÅ•Â∫∑Êï∞ÊçÆÂàÜÊûê</span>
                    <span class="health-analysis-subtitle">ÊúÄËøë7Â§©</span>
                </div>
                <div class="panel-content">
                    <!-- ÂÅ•Â∫∑Ë∂ãÂäøÂõæ -->
                    <div id="trendChart" class="health-trend-chart">
                        <div class="chart-title">üìä ÂÅ•Â∫∑Ë∂ãÂäøÂàÜÊûê</div>
                    </div>
                </div>
            </div>
            
            <div class="panel health-score-panel">
                <div class="panel-header">
                    <span>üèÜ ÂÅ•Â∫∑ËØÑÂàÜ</span>
                    <span class="total-score">ÊÄªÂàÜÔºö94.5</span>
                </div>
                <div class="panel-content">
                    <!-- ËØÑÂàÜÊòæÁ§∫Âå∫Âüü -->
                    <div class="score-display">
                        <div class="score-main">
                            <div class="score-circle">
                                <div class="score-number">94.5</div>
                            </div>
                            <div class="score-info">
                                <div class="score-title">ÁªºÂêàÂÅ•Â∫∑ËØÑÂàÜ</div>
                                <div class="score-status">ËâØÂ•ΩÁä∂ÊÄÅ</div>
                            </div>
                        </div>
                        <div style="color: rgba(255,255,255,0.6); font-size: 12px; cursor: pointer;" onclick="showScoreDetails()">
                            ËØ¶ÊÉÖ ‚Üí
                        </div>
                    </div>
                    <!-- ÂõæË°®Âå∫Âüü -->
                    <div id="healthScoreChart" class="chart-container"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ê®°ÊÄÅÊ°Ü -->
    <div id="personnelModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‰∫∫ÂëòËØ¶ÊÉÖ</h3>
                <span class="modal-close" onclick="closePersonnelModal()">&times;</span>
            </div>
            <div class="modal-body" id="personnelModalBody">
                <!-- Âä®ÊÄÅÂä†ËΩΩÂÜÖÂÆπ -->
            </div>
        </div>
    </div>

    <!-- Â§ñÈÉ®JavaScriptÊ®°Âùó -->
    <script src="{{ url_for('static', filename='js/bigscreen/constants.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bigscreen/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bigscreen/globals.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bigscreen/chart-configs.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bigscreen/personnel-filter.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bigscreen/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bigscreen/app.js') }}"></script>
    
    <!-- È°µÈù¢ÂàùÂßãÂåñ -->
    <script>
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ È°µÈù¢Âä†ËΩΩÂÆåÊàêÔºåÂºÄÂßãÂàùÂßãÂåñ...');
            
            // ËÆæÁΩÆÂÆ¢Êà∑ID
            if (typeof window !== 'undefined') {
                window.CUSTOMER_ID = '{{ customerId }}';
                window.BIGSCREEN_TITLE = '{{ BIGSCREEN_TITLE }}';
            }
            
            // ÂàùÂßãÂåñÂ∫îÁî®
            if (typeof initializeApp === 'function') {
                initializeApp();
            }
        });
    </script>
</body>
</html> 