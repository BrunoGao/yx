<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generated by Codia AI</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400&display=swap" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/bigscreen/alert.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/profile-button.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" />
    <style>
      body {
        font-family: 'Inter', sans-serif; /* å­—ä½“ */
        background-color: rgba(30, 30, 30, 0.1); /* èƒŒæ™¯è‰² with 80% opacity */
        color: #ffffff; /* æ–‡æœ¬é¢œè‰² */
        margin: 0;
        padding: 0;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 0.9em; /* è®¾ç½®è¡¨æ ¼å­—ä½“å¤§å° */
        min-width: 400px;
        background-color: #2e2e2e;
        border-radius: 8px; /* åœ†è§’ */
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* æ·»åŠ é˜´å½±æ•ˆæœ */
    }
    .table-header {
      display: contents; /* ä¸å­å…ƒç´ å…±äº«ç½‘æ ¼å¸ƒå±€ */
      font-weight: bold;
      color: #66ccff; /* è¡¨å¤´é¢œè‰² */
      padding: 8px 0;
    }
    
    thead tr {
        background-color: #3e3e3e; /* è¡¨å¤´èƒŒæ™¯ */
        font-size: 1em; /* è¡¨å¤´å­—ä½“å¤§å° */
        text-transform: uppercase; /* è¡¨å¤´å¤§å†™ */
        letter-spacing: 0.03em;
        color: #ffffff;
    }
    
    th, td {
        padding: 15px; /* å¢åŠ é—´è· */
        text-align: left;
        font-size: 0.95em; /* å•å…ƒæ ¼å­—ä½“å¤§å° */
    }
    
    tbody tr {
        border-bottom: 1px solid #444; /* æ·»åŠ åº•éƒ¨è¾¹æ¡† */
        transition: all 0.2s ease; /* é¼ æ ‡æ‚¬åœæ•ˆæœ */
    }
    
    tbody tr:nth-of-type(even) {
        background-color: #3a3a3a; /* å¶æ•°è¡Œé¢œè‰² */
    }
    
    tbody tr:hover {
        background-color: #454545; /* æ‚¬åœé«˜äº®é¢œè‰² */
        transform: scale(1.01); /* å¾®å°æ”¾å¤§æ•ˆæœ */
    }
    
    .badge {
        display: inline-block;
        padding: 5px 10px;
        border-radius: 12px; /* è°ƒæ•´åœ†è§’ */
        color: #fff;
        font-weight: bold;
        font-size: 0.85em; /* è°ƒæ•´å¾½ç« å­—ä½“å¤§å° */
    }
    
    .badge.active {
        background-color: #28a745; /* ç»¿è‰²å¾½ç«  */
    }
    
    .badge.danger {
        background-color: #dc3545; /* çº¢è‰²å¾½ç«  */
    }
    
    .badge.pending {
        background-color: #ffc107; /* é»„è‰²å¾½ç«  */
    }
    .location-container {
      display: flex;
      align-items: center;
      padding: 8px 0; /* æ§åˆ¶ä¸Šä¸‹é—´è· */
      color: #ffffff;
      font-family: 'Inter', sans-serif;
      background-color: transparent; /* èƒŒæ™¯é€æ˜ */
    }
    
    .location-icon {
      font-size: 20px; /* å›¾æ ‡å¤§å° */
      margin-right: 8px; /* å›¾æ ‡ä¸å†…å®¹é—´è· */
    }
    
    .location-details {
      display: flex;
      flex-direction: column; /* å‚ç›´æ’åˆ—çº¬åº¦å’Œç»åº¦ */
    }
    
    .latitude,
    .longitude {
      font-size: 14px; /* å­—ä½“å¤§å° */
      line-height: 1.5;
    }
    
    .value {
      font-weight: bold; /* çªå‡ºæ•°å€¼ */
      color: #66ccff; /* æ•°å€¼é¢œè‰² */
    }
    .phone-time-container {
      width: 100%;
      background-color: transparent; /* èƒŒæ™¯é€æ˜ */
      padding: 10px 0; /* å†…è¾¹è· */
    }
    
    .phone-time-item {
      display: flex;
      align-items: center;
      padding: 8px 16px; /* æ§åˆ¶æ¯æ¡è®°å½•çš„å†…è¾¹è· */
      font-family: 'Inter', sans-serif;
      color: #ffffff; /* æ–‡å­—é¢œè‰² */
      font-size: 14px;
    }
    
    .icon {
      font-size: 18px;
      margin-right: 8px; /* å›¾æ ‡ä¸æ–‡å­—çš„é—´è· */
      color: #66ccff; /* å›¾æ ‡é¢œè‰² */
    }
    
    .phone-number {
      font-weight: bold; /* çªå‡ºæ‰‹æœºå·ç  */
      margin-right: 16px; /* æ‰‹æœºå·ç ä¸æ—¶é—´çš„é—´è· */
    }
    
    .timestamp {
      color: #aaaaaa; /* æ—¶é—´é¢œè‰²ç¨å¾®æ·¡ä¸€äº› */
    }
    
    .divider {
      height: 1px;
      background-color: #444444; /* åˆ†éš”çº¿é¢œè‰² */
      margin: 4px 16px; /* åˆ†éš”çº¿çš„è¾¹è· */
    }
    .phone-number {
      font-weight: bold; /* æ‰‹æœºå·ç åŠ ç²— */
    }
    
    .timestamp {
      color: #aaaaaa; /* æ—¶é—´é¢œè‰²æ›´æ·¡ */
    }
    .column {
      padding: 8px 12px; /* åˆ—çš„å†…è¾¹è· */
      text-align: left; /* å·¦å¯¹é½ */
    }
    .profile-button a {
      color: #28a745; /* é“¾æ¥æ–‡å­—ä¸ºç»¿è‰² */
      text-decoration: none;
      font-size: 12px; 
  }
  
  .profile-button a:hover {
      color: #1e7e34; /* é¼ æ ‡æ‚¬åœæ—¶ï¼Œæ–‡å­—å˜æ·±ç»¿ */
  }
    
    </style>
  </head>
  <body>
    <div class="main-container">
      <div class="cards">
        <div class="table-container" style="max-height: 600px; overflow-y: auto;">
          <table>
            <thead class="table-header">
              <tr>
                <th>ID</th>
                <th>éƒ¨é—¨</th>
                <th>ç”¨æˆ·å</th>
                <th>æŠ¥è­¦ç±»å‹</th>
                <th>ä½ç½®</th>
                <th>æ—¶é—´</th>
                <th>å¤„ç†</th>
              </tr>
            </thead>
            <tbody id="alerts-container">
              <!-- Alerts will be dynamically inserted here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
 
    <script>
      function getQueryParameter(name) {
        const urlParams = new URLSearchParams(window.location.search); // Get query params from the current URL
        return urlParams.get(name); // Get the value of the 'name' parameter
      }

      // Function to fetch alerts from the server
      function fetchAlerts(customerId) {
        fetch('./get_alerts_by_orgIdAndUserId?orgId=' + customerId)
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              const alertsContainer = document.getElementById('alerts-container');
              alertsContainer.innerHTML = ''; // Clear existing content
              console.log("data:", data.data.alerts);

              // éå†å‘Šè­¦æ•°æ®
              data.data.alerts.forEach(alert => {
                const alertRow = document.createElement('tr');
                let buttonClass = '';
                let spanClass = '';

                switch (alert.alert_type.toLowerCase()) {  // æ”¹ä¸º alert_type
                  case 'å¿ƒç‡å¼‚å¸¸':
                    buttonClass = 'button';
                    spanClass = 'oct';
                    break;
                  case 'è¡€å‹å¼‚å¸¸':
                    buttonClass = 'button-danger';
                    spanClass = 'oct-danger';
                    break;
                  case 'è¡€æ°§å¼‚å¸¸':
                    buttonClass = 'button-pending';
                    spanClass = 'oct-pending';
                    break;
                  case 'ä½“æ¸©å¼‚å¸¸':
                    buttonClass = 'button-temperature';
                    spanClass = 'oct-temperature';
                    break;
                  case 'è·Œå€’å‘Šè­¦':
                    buttonClass = 'button-fall';
                    spanClass = 'oct-fall';
                    break;
                  case 'soså‘Šè­¦':
                    buttonClass = 'button-sos';
                    spanClass = 'oct-sos';
                    break;
                  default:
                    buttonClass = 'status-default';
                    spanClass = 'oct-default';
                }
                alertRow.innerHTML = `
                  <td>${alert.alert_id}</td>
                  <td> <div class="simple-68"><div class="image-69"></div><span class="monna-liza-6b">${alert.dept_name}</span></div></td>
                  
                  <td><div class="column phone-number"><span class="icon">âŒš</span> ${alert.user_name}</div></td>
                  <td> 
                    <button class="${buttonClass}">
                      <span class="${spanClass}">${alert.alert_type}</span>
                    </button>
                  </td>
                  <td>
                    <div class="location-container">
                      <span class="location-icon">ğŸ“</span>
                      <div class="location-details">
                      <div class="latitude">çº¬åº¦: <span class="value">${alert.latitude || 'N/A'}</span></div>
                      <div class="longitude">ç»åº¦: <span class="value">${alert.longitude || 'N/A'}</span></div>
                      </div>
                    </div>
                  </td>
                  <td><div class="column timestamp"><span class="icon">â°</span> ${alert.alert_timestamp}</div></td>
                  <td><button class="profile-button"><a href="./dealAlert?alertId=${alert.alert_id}">ä¸€é”®å¤„ç†</a></button></td>
                `;
                alertsContainer.appendChild(alertRow);
              });
            } else {
              console.error('Failed to fetch alerts:', data.error);
            }
          })
          .catch(error => console.error('Error fetching alerts:', error));
      }

      // Fetch alerts when the page loads
      window.onload = () => {
        const customerId = getQueryParameter('customerId'); // Extract customerId from URL
        if (customerId) {
          fetchAlerts(customerId); // Pass customerId to fetchAlerts function
        } else {
          console.error('No customerId found in the URL');
        }
      };
    </script>
    <!-- Generated by Codia AI - https://codia.ai/ -->
  </body>
</html>
