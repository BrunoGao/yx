<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generated by hg-tech</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Han+Sans+CN:wght@400;500;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Barlow:wght@700&display=swap" />

    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main-index.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main-data.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main-alert.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main-index1.css') }}">

    <script src="https://webapi.amap.com/maps?v=2.0&key=96885cc5d4c3ea6061b09ecbeab4011f&plugin=AMap.ControlBar,AMap.ToolBar"></script> 
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <style>
      #redCloseBtn {
        z-index: 9999; /* 确保层级高于其他内容 */
        pointer-events: auto; /* 确保可以点击 */
        cursor: pointer; /* 鼠标样式为手型 */
    }
    #yellowCloseBtn {
      z-index: 9999; /* 确保层级高于其他内容 */
      pointer-events: auto; /* 确保可以点击 */
      cursor: pointer; /* 鼠标样式为手型 */
  }
    .amap-info-content {
        pointer-events: auto; /* 确保整个内容可交互 */
        z-index: 9999; /* 确保自定义 InfoWindow 层级不被遮挡 */
    }
    </style>
    </head>
  <body>
    <div class="main-container">
      <div class="flex-row-eba">
        <div class="mask-group">
          <div class="flex-row-bee">
            <div class="vector"></div>
            <div class="vector-1"></div>
          </div>
          <div class="flex-row-e">
            <span class="system-data-visualization">  灵境万象总览大屏</span>
          
          </div>
          <div class="flex-row-c">
            <div class="vector-11"></div>
            <div class="vector-12"></div>
          </div>
        </div>
        <div class="group-13">
          <div class="rectangle">
            <span class="time">15:04:22 </span>
            
            <span class="date">2022-11-25</span>
            <span class="weather">天气：多云</span>
            <span class="day">星期一</span>
          
          </div>
        </div>
        <div class="group-18">
          <div class="flex-row-ed">
            <div class="vector-19"></div>
            <div class="regroup">
              <div class="vector-1a"></div>
              <div class="vector-1b"></div>
            </div>
          </div>
          <div class="flex-row-ffe">
            <div class="rectangle-1c">
              <div class="rectangle-1d">
                <div class="rectangle-1e">
                  <span class="home-1f">首页</span>
                </div>
              </div>
            </div>
            <div class="rectangle-20">
              <div class="rectangle-21">
                <div class="rectangle-22">
                  <span class="data-dashboard">数据看板</span>
                </div>
              </div>
            </div>
            <div class="rectangle-23">
              <div class="rectangle-24">
                <div class="rectangle-25">
                  <span class="data-dashboard-26">数据看板</span>
                </div>
              </div>
            </div>
            <div class="rectangle-27">
              <div class="rectangle-28">
                <div class="rectangle-29">
                  <span class="more-dashboard">更多看板</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

  
      <div class="flex-row">
        <div id="alarm-overview">
        <div class="rectangle-backup">
        
          <span class="resident-population">告警处理概览</span>
        </div>

        <div class="group-110">
          <span class="number">68</span><span class="percentage">%</span>
        </div>
     
        <div class="rectangle-128">
          <div class="flex-row-c-129">
            <button class="frame-12a">
              <div class="group-12b"><span class="number-12c">123</span></div>
              <div class="group-12d">
                <span class="permanent-population">已完成</span>
              </div>
              
              
            </button>
           
            <div class="xml-id"></div>
            <div class="xml-id-12e"></div>
            <div class="xml-id-12f"></div>
            <div class="xml-id-130"></div>
            <div class="xml-id-131"></div>
            <div class="xml-id-132"></div>
          </div>
          <div class="flex-row-b-133">
            <div class="xml-id-134"></div>
            <div class="xml-id-135"></div>
          </div>
          <div class="xml-id-136"></div>
        </div>

      </div>
    
      
        <div id="map" class="map"></div>
        <div class="rectangle-c7">
          <div class="rectangle-c8"></div>
          <div class="rectangle-c9"></div>
          <div class="rectangle-ca"></div>
          <div class="rectangle-cb"></div>
          <div class="rectangle-cc"></div>
          <div class="rectangle-cd"></div>
          <div class="rectangle-ce"></div>
          <div class="rectangle-cf"></div>
          <div class="rectangle-d0"></div>
          <div class="rectangle-d1"></div>
          <div class="rectangle-d2"></div>
          <div class="rectangle-d3"></div>
          <div class="rectangle-d4"></div>
          <div class="rectangle-d5"></div>
          <div class="rectangle-d6"></div>
          <div class="rectangle-d7"></div>
          <div class="rectangle-d8"></div>
          <div class="rectangle-d9"></div>
          <div class="rectangle-da"></div>
          <div class="rectangle-db"></div>
          <div class="rectangle-dc"></div>
          <div class="rectangle-dd"></div>
          <div class="rectangle-de"></div>
          <div class="rectangle-df"></div>
          <div class="rectangle-e0"></div>
          <div class="rectangle-e1"></div>
          <div class="rectangle-e2"></div>
          <div class="rectangle-e3"></div>
          <div class="rectangle-e4"></div>
          <div class="rectangle-e5"></div>
          <div class="rectangle-e6"></div>
        </div>
        <div class="flex-row-ca">
          
          <div class="rectangle-108">
            <div class="frame-109"></div>
            <span class="no-emergency-response">目前暂无应急告警</span>
          </div>
        </div>
        <div class="rectangle-c7-b">
          <div class="rectangle-c8"></div>
          <div class="rectangle-c9"></div>
          <div class="rectangle-ca"></div>
          <div class="rectangle-cb"></div>
          <div class="rectangle-cc"></div>
          <div class="rectangle-cd"></div>
          <div class="rectangle-ce"></div>
          <div class="rectangle-cf"></div>
          <div class="rectangle-d0"></div>
          <div class="rectangle-d1"></div>
          <div class="rectangle-d2"></div>
          <div class="rectangle-d3"></div>
          <div class="rectangle-d4"></div>
          <div class="rectangle-d5"></div>
          <div class="rectangle-d6"></div>
          <div class="rectangle-d7"></div>
          <div class="rectangle-d8"></div>
          <div class="rectangle-d9"></div>
          <div class="rectangle-da"></div>
          <div class="rectangle-db"></div>
          <div class="rectangle-dc"></div>
          <div class="rectangle-dd"></div>
          <div class="rectangle-de"></div>
          <div class="rectangle-df"></div>
          <div class="rectangle-e0"></div>
          <div class="rectangle-e1"></div>
          <div class="rectangle-e2"></div>
          <div class="rectangle-e3"></div>
          <div class="rectangle-e4"></div>
          <div class="rectangle-e5"></div>
          <div class="rectangle-e6"></div>
        </div>
        

        <div id="data-statistics">

            <div class="rectangle-backup-92">
              
              <span class="overview-statistics">数据统计</span>
          
              <div class="line-9a"></div>
            </div>
            <div class="rectangle-137"></div>
            <div class="rectangle-138"></div>
            <div class="rectangle-139"></div>
            <div class="mask-group-13a">
              <span class="number-13b">10</span>
              <div class="pic-85"></div>
            </div>
            <div class="rectangle-13c"></div>
            <div class="rectangle-13d"></div>
            <div class="rectangle-13e"></div>
            <div class="rectangle-13f"></div>
            <button class="group-140"></button>
            <div class="rectangle-141"></div>
            <div class="rectangle-142"></div>
            <div class="polygon-143">
              <div class="polygon-144">
                <div class="frame-145"><div class="vector-146"></div></div>
              </div>
            </div>
            <div class="polygon-147">
              <div class="polygon-148">
                <div class="frame-149"><div class="vector-14a"></div></div>
              </div>
            </div>

            <div class="polygon">
              <div class="polygon-111">
                <div class="frame-112"><div class="vector-113"></div></div>
              </div>
            </div>
            <div class="polygon-114">
              <div class="polygon-115">
                <div class="frame-116"><div class="vector-117"></div></div>
              </div>
            </div>

            <div class="rectangle-118"></div>
            <div class="frame-119">
              <span class="data-type-count">佩戴统计（个）</span>
              <div class="group-11a">
                <div class="group-11b">
                  <div class="group-11c">
                    <div class="group-11d">
                      <span class="number-11e">48/50</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="frame-11f">
              <span class="data-type-count-120">在线统计（个）</span>
              <div class="group-121">
                <div class="group-122">
                  <div class="group-123">
                    <div class="group-124">
                      <span class="number-125">44/50</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
      
              
            <div class="rectangle-118"></div>
            <div class="frame-11f">
              <span class="data-type-count-120">在线统计（个）</span>
              <div class="group-121">
                <div class="group-122">
                  <div class="group-123">
                    <div class="group-124">
                      <span class="number-125">44/50</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="frame-150">
              <span class="data-type-151">升级统计（个）</span>
              <div class="group-152">
                <div class="group-153">
                  <div class="group-154">
                    <div class="group-155">
                      <span class="comma-156">49/50</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="frame-14b">
              <span class="data-type">告警统计（个）</span>
              <div class="group-14c">
                <div class="group-14d">
                  <div class="group-14e">
                    <div class="group-14f"><span class="comma">32</span></div>
                  </div>
                </div>
              </div>
            </div>
        </div>
        <div id="alarm-statistics-chart">

            <div class="rectangle-backup-168">
              <div class="rectangle-backup-169">
                <div class="rectangle-16a"></div>
                <div class="rectangle-16b"></div>
              </div>
              <div class="flex-row-16c">
                <span class="overview-statistics-16d">告警处理分时走势</span>
                <div class="frame-16e"><button class="on-time">按时</button></div>
                <button class="frame-16f"><span class="by-day">按天</span></button
                ><button class="frame-170">
                  <span class="by-month">按月</span>
                </button>
                <div id="chart"></div> 
              </div>
              <div class="flex-row-a-171">
                <div class="rectangle-backup-172"></div>
                <div class="line-173"></div>
                <div class="line-174"></div>
                <div class="line-175"></div>
              </div>
              <div class="line-176"></div>
            </div>  

            <div class="rectangle-137"></div>
            <div class="rectangle-138"></div>
            <div class="rectangle-139"></div>
            <div class="mask-group-13a">
              <span class="number-13b">10</span>
              <div class="pic-85"></div>
            </div>
            <div class="mask-group-159">
              <span class="number-15a">20</span>
              <div class="line-15b"></div>
            </div>
            <div class="mask-group-177">
              <span class="number-178">30</span>
              <div class="line-179"></div>
            </div>

            <span class="span">40</span>
            <div class="rectangle-188"></div>
            <div class="rectangle-189"></div>
            <div class="mask-group-18a">
              <div class="flex-column-f">
                <div class="rectangle-18b"></div>
                <div class="ellipse-18c"></div>
              </div>
              <div class="flex-column-fab">
                <div class="line-18d"></div>
                <div class="line-18e"></div>
                <div class="line-18f"></div>
                <button class="rectangle-190">
                  <span class="span-191">12</span>
                  <div class="polygon-192"></div>
                </button>
                <div class="line-193"></div>
              </div>
            </div>
            <div class="mask-group-194">
              <span class="span-195">40</span>
              <div class="line-196"></div>
            </div>
            <div class="rectangle-197"></div>
            <div class="ellipse-198"></div>
            <div class="ellipse-199"></div>
            <span class="span-19a">30 </span>
            <div class="rectangle-19b"></div>
            <div class="rectangle-19c"></div>

            <div class="rectangle-1c1"></div>
            <div class="rectangle-1c2"></div>
            <span class="span-1c3">20</span>
            <div class="rectangle-1c4"></div>
            <div class="rectangle-1c5"></div>
            <div class="rectangle-1c6"></div>
            <span class="span-1c7">10</span>
            <div class="rectangle-1c8"></div>

            <div class="group-28"></div>
            <span class="zero-1cc">0</span>
          
            <div class="mask-group-1d2"><span class="time-08-00">08:00</span></div>
            <div class="mask-group-1d3"><span class="time-09-00">09:00</span></div>
            <div class="mask-group-1d4"><span class="time-10-00">10:00</span></div>
            <div class="mask-group-1d5"><span class="time-11-00">11:00</span></div>
            <div class="mask-group-1d6"><span class="time-12-00">12:00</span></div>
            <div class="mask-group-1d7"><span class="time-13-00">13:00</span></div>
            <div class="mask-group-1d8"><span class="time-14-00">14:00</span></div>
            <div class="mask-group-1d9"><span class="time-15-00">15:00</span></div>

        </div>

        <div id="alarm-statistics">
  
            <div class="rectangle-backup-17a">
              <div class="rectangle-backup-17b">
                <div class="rectangle-17c"></div>
                <div class="rectangle-17d"></div>
              </div>
              <span class="overview-statistics-17e">告警统计</span>
              <div class="flex-row-ebdb">
                <div class="rectangle-backup-17f"></div>
                <div class="line-180"></div>
                <div class="line-181"></div>
                <div class="line-182"></div>
              </div>
              <div class="line-183"></div>
            </div>

      
            <div class="ellipse-19d">
              <div class="group-19e">
                <div class="group-19f">
                  <div class="percent">
                    <span class="span-1a0">26</span
                    ><span class="percent-1a1">.5%</span>
                  </div>
                  <span class="data-type-1a2">心率异常</span>
                </div>
              </div>
            </div>
            <div class="rectangle-1a3"></div>
            <div class="rectangle-1a4"></div>
            <div class="frame-1a5">
              <div class="frame-1a6">
                <div class="frame-1a7">
                  <div class="frame-1a8">
                    <div class="ellipse-1a9"></div>
                    <span class="type-one">体温</span>
                  </div>
                </div>
                <div class="frame-1aa">
                  <div class="frame-1ab">
                    <div class="ellipse-1ac"></div>
                    <span class="type-two">心率</span>
                  </div>
                </div>
                <div class="frame-1ad">
                  <div class="frame-1ae">
                    <div class="ellipse-1af"></div>
                    <span class="type-three">血压</span>
                  </div>
                </div>
                <div class="frame-1b0">
                  <div class="frame-1b1">
                    <div class="ellipse-1b2"></div>
                    <span class="type-four">血氧</span>
                  </div>
                </div>
                <div class="frame-1b3">
                  <div class="frame-1b4">
                    <div class="ellipse-1b5"></div>
                    <span class="type-five">跌倒</span>
                  </div>
                </div>
              </div>
              <div class="frame-1b6">
                <div class="frame-1b7"><span class="percent-1b8">10.28%</span></div>
                <div class="frame-1b9"><span class="percent-1ba">26.50%</span></div>
                <div class="frame-1bb"><span class="percent-1bc">23.14%</span></div>
                <div class="frame-1bd"><span class="percent-1be">20.50%</span></div>
                <div class="frame-1bf"><span class="percent-1c0">10.28%</span></div>
              </div>
            </div>
        </div>
    
      <div id="alarm-detail">
            <div class="group-1e4"></div>
            <div class="rectangle-1e5"></div> 
            <div class="backup-rectangle">
              <div class="backup-rectangle-1e6">
                <div class="rectangle-1e7"></div>
                <div class="rectangle-1e8"></div>
              </div>
              <span class="resident-population-overview">告警明细</span>
              <div class="flex-row-cc">
                <div class="backup-rectangle-1e9"></div>
                <div class="line-1ea"></div>
                <div class="line-1eb"></div>
                <div class="line-1ec"></div>
              </div>
              <div class="line-1ed"></div>
            </div>
          
            <div class="frame-209">
              <span class="total-supplies">告警总数（个）</span>
              <div class="group-20a">
                <div class="group-33">
                  <div class="group-20b">
                    <div class="group-20c">
                      <span id="total-alerts" class="span-20d">288</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="frame-20e">
              <span class="span-20f">告警种类（种）</span>
              <div class="group-210">
                <div class="group-211">
                  <div class="group-212">
                    <div class="group-213"><span class="span-214" id="unique-alert-types">18</span></div>
                  </div>
                </div>
              </div>
            </div>
      
            <div class="rectangle-224">
              <span class="span-225">设备序列号</span
              ><span class="span-226">告警类型</span
              ><span class="span-227">告警时间</span>
            </div>
        
            <div id="alerts-container">
              <!-- Alerts will be dynamically inserted here -->
            </div>

      </div>
        <div class="backup-rectangle-1ef">
          <div class="backup-rectangle-1f0">
            <div class="rectangle-1f1"></div>
            <div class="rectangle-1f2"></div>
          </div>
          <span class="resident-population-overview-1f3">视频监控</span>
          <div class="flex-row-ca-1f4">
            <div class="backup-rectangle-1f5"></div>
            <div class="line-1f6"></div>
            <div class="line-1f7"></div>
            <div class="line-1f8"></div>
          </div>
          <div class="line-1f9"></div>
        </div>
        <div class="rectangle-1fc"></div>
        <div class="rectangle-1fd"></div>
        <div class="rectangle-1fe">
          <div class="rectangle-1ff"></div>
          <div class="flex-row-c-200">
            <div class="mask-group-201"></div>
            <div class="rectangle-202"></div>
          </div>
        </div>
        <div class="rectangle-203"></div>
        <div class="rectangle-204">
          <div class="rectangle-205"></div>
          <div class="flex-row-ba">
            <div class="frame-206"><div class="vector-207"></div></div>
            <div class="rectangle-208"></div>
          </div>
        </div>
   
        <div class="group-21a"></div>
        <div class="group-21b"></div>
        <div class="rectangle-21c"></div>
        <div class="group-21d"></div>

        <span class="span-235">A1-视频监控</span
        <span class="span-236">A1-视频监控</span>
 
     
      </div>
      <div class="flex-row-26d">
        <div class="rectangle-backup-26e">
          <div class="flex-row-ce">
            <div class="rectangle-backup-26f">
              <div class="rectangle-270"></div>
            </div>
            <div class="rectangle-271"></div>
          </div>
          <span class="overview-statistics-272">告警时段分布</span>
          <div class="flex-row-cbe">
            <div class="rectangle-backup-273"></div>
            <div class="line-274"></div>
            <div class="line-275"></div>
            <div class="line-276"></div>
          </div>
          <div class="line-277"></div>
        </div>
        <div class="rectangle-backup-278">
          <div class="flex-row-ca-279">
            <div class="rectangle-backup-27a">
              <div class="rectangle-27b"></div>
            </div>
            <div class="rectangle-27c"></div>
          </div>
          <span class="overview-statistics-27d">紧急告警</span>
          <div class="flex-row-a-27e">
            <div class="rectangle-backup-27f"></div>
            <div class="line-280"></div>
            <div class="line-281"></div>
            <div class="line-282"></div>
          </div>
          <div class="line-283"></div>
        </div>
      </div>
      <div class="flex-row-284">
       
        <span class="date-2022-11-23-11-37-25">2024-11-23 11:37:25</span>
        <div class="vector-286">
          <div class="vector-287"></div>
          <div class="vector-288"></div>
          <div class="vector-289"></div>
          <div class="vector-28a"></div>
          <div class="vector-28b"></div>
          <div class="vector-28c"></div>
          <div class="vector-28d"></div>
          <div class="vector-28e"></div>
          <div class="vector-28e"></div>
      
        </div>
        <div class="vector-28f">
          <div class="vector-290"></div>
          <div class="vector-291"></div>
          <div class="vector-292"></div>
          <div class="vector-293"></div>
          <div class="vector-294"></div>
          <div class="vector-295"></div>
          <div class="vector-296"></div>
          <div class="vector-297"></div>
          <div class="vector-298"></div>
          <div class="vector-299"></div>
          <div class="vector-29a"></div>
          <div class="vector-29b"></div>
        </div>
        <div class="vector-29c">
          <div class="vector-29d"></div>
          <div class="vector-29e"></div>
          <div class="vector-29f"></div>
          <div class="vector-2a0"></div>
          <div class="vector-2a1"></div>
          <div class="vector-2a2"></div>
          <div class="vector-2a3"></div>
          <div class="vector-2a4"></div>
          <div class="vector-2a5"></div>
        </div>
        <div class="vector-2a6">
          <div class="vector-2a7"></div>
          <div class="vector-2a8"></div>
          <div class="vector-2a9"></div>
          <div class="vector-2aa"></div>
          <div class="vector-2ab"></div>
          <div class="vector-2ac"></div>
          <div class="vector-2ad"></div>
          <div class="vector-2ae"></div>
          <div class="vector-2af"></div>
          <div class="vector-2b0"></div>
          <div class="vector-2b1"></div>
          <div class="vector-2b2"></div>
          <div class="vector-2b3"></div>
        </div>
        <div class="vector-2b4">
          <div class="vector-2b5"></div>
          <div class="vector-2b6"></div>
          <div class="vector-2b7"></div>
          <div class="vector-2b8"></div>
          <div class="vector-2b9"></div>
          <div class="vector-2ba"></div>
          <div class="vector-2bb"></div>
          <div class="vector-2bc"></div>
          <div class="vector-2bd"></div>
        </div>
        <div class="vector-2be">
          <div class="vector-2bf"></div>
          <div class="vector-2c0"></div>
          <div class="vector-2c1"></div>
          <div class="vector-2c2"></div>
          <div class="vector-2c3"></div>
          <div class="vector-2c4"></div>
          <div class="vector-2c5"></div>
        </div>
        <div class="vector-2c5">
          <div class="vector-2c6"></div>
          <div class="vector-2c7"></div>
          <div class="vector-2c8"></div>
          <div class="vector-2c9"></div>
          <div class="vector-2ca"></div>
          <div class="vector-2cb"></div>
          <div class="vector-2cc"></div>
          <div class="vector-2cd"></div>
          <div class="vector-2ce"></div>
        </div>
        <div class="vector-2cf">
          <div class="vector-2d0"></div>
          <div class="vector-2d1"></div>
          <div class="vector-2d2"></div>
          <div class="vector-2d3"></div>
          <div class="vector-2d4"></div>
          <div class="vector-2d5"></div>
          <div class="vector-2d6"></div>
          <div class="vector-2d7"></div>
          <div class="vector-2d8"></div>
          <div class="vector-2d9"></div>
          <div class="vector-2da"></div>
          <div class="vector-2db"></div>
          <div class="vector-2dc"></div>
          <div class="vector-2dd"></div>
        </div>
        <div class="group-2dc"></div>
        <div class="group-2dd"></div>
        <div class="rectangle-2de">
          <div class="frame-2df"></div>
          <span class="level-one">Ⅰ级</span>
        </div>
        <div class="rectangle-2e0">
          <span id="emergency-message" class="emergency-message">admin3 突发跌倒，心率异常，请立即前往处理！</span
          >
        </div>
      
      
        <span class="span-2f9">2024-11-23 09:37:25</span>
        <div class="div">
          <div class="div-2fa"></div>
          <span class="span-2fb">Ⅱ级</span>
        </div>
        <span class="span-2fc">A1-频监控</span
        ><span class="span-2fd">A1-视频监控</span>
        <div class="div-2fe"></div>
      </div>
      <div class="div-2ff">
       
        <div class="div-304">
          <span id="warning-message" class="warning-message">admin3 体温异常，请立即前往处理！</span
          >
        </div>
      </div>
      <div class="flex-row-318">
        <div class="mask-group-319">
          <span class="time-range-0-1h">0-1h</span>
        </div>
        <div class="mask-group-31a">
          <span class="time-range-1-2h">1-2h</span>
        </div>
        <div class="mask-group-31b">
          <span class="time-range-2-3h">2-3h</span>
        </div>
        <div class="mask-group-31c">
          <span class="time-range-3-4h">3-4h</span>
        </div>
        <div class="mask-group-31d">
          <span class="time-range-4-5h">4-5h</span>
        </div>
        <div class="mask-group-31e">
          <span class="time-range-5-6h">5-6h</span>
        </div>
        <div class="mask-group-31f">
          <span class="time-range-7-8h">7-8h</span>
        </div>
        <div class="mask-group-320"><span class="time-range-8h">8h</span></div>
      </div>
      <div class="flex-row-321">
        <div class="group-322"></div>
        <div class="group-323"></div>
        <div class="group-324"></div>
        <div class="group-325"></div>
      </div>
    </div>
    <!-- Generated by Codia AI - https://codia.ai/ -->
    <script>
      // Initialize the chart
      var chart = echarts.init(document.getElementById('chart'));
     

      // Chart configuration
      var option = {
          backgroundColor: '#1e1e2f',
          title: {
              text: '告警处理分时走势',
              left: 'center',
              textStyle: {
                  color: '#fff',
                  fontSize: 18
              }
          },
          tooltip: {
              trigger: 'axis',
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              borderColor: '#333',
              borderWidth: 1,
              textStyle: {
                  color: '#fff'
              },
              formatter: function (params) {
                  var data = params[0];
                  return `时间: ${data.axisValue}<br>值: ${data.data}`;
              }
          },
          grid: {
              left: '10%',
              right: '10%',
              bottom: '15%',
              top: '20%',
              containLabel: true
          },
          xAxis: {
              type: 'category',
              boundaryGap: false,
              data: ['08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00'],
              axisLine: {
                  lineStyle: {
                      color: '#2b2b3d'
                  }
              },
              axisLabel: {
                  color: '#fff'
              }
          },
          yAxis: {
              type: 'value',
              axisLine: {
                  lineStyle: {
                      color: '#2b2b3d'
                  }
              },
              axisLabel: {
                  color: '#fff'
              },
              splitLine: {
                  lineStyle: {
                      color: '#2b2b3d'
                  }
              }
          },
          series: [
              {
                  name: '处理次数',
                  type: 'line',
                  smooth: true,
                  data: [5, 10, 15, 20, 25, 30, 35, 40],
                  lineStyle: {
                      color: '#4caf50',
                      width: 2
                  },
                  areaStyle: {
                      color: 'rgba(76, 175, 80, 0.2)'
                  },
                  symbol: 'circle',
                  symbolSize: 6,
                  itemStyle: {
                      color: '#4caf50',
                      borderColor: '#2b2b3d',
                      borderWidth: 2
                  }
              }
          ]
      };

      // Set the option
      chart.setOption(option);
  </script>
  <script src="https://webapi.amap.com/maps?v=2.0&key=7de0c6b90cb13571ce931ca75a66c6e7&plugin=AMap.ControlBar,AMap.ToolBar"></script> 
  <script src="//webapi.amap.com/loca?v=2.0.0&key=7de0c6b90cb13571ce931ca75a66c6e7"></script>
  <script>
    function initializeMap() {
      //console.log(AMap); // 如果打印 `undefined`，说明 AMap 没有正确加载
      //console.log(Loca); // 如果打印 `undefined`，说明 Loca 没有正确加载
      var geoLevelF = new Loca.GeoJSONSource({
        //url: 'https://a.amap.com/Loca/static/loca-v2/demos/mock_data/sz_road_F.json',
        //url: "http://localhost:5001/static/data/alert.json",
        url: "http://localhost:5001/generateAlertJson?customerId={{ customerId }}&severityLevel=Critical",
        
       });
      
      // 手动加载数据
      geoLevelF.load();
      console.log('geoLevelF.dataset',geoLevelF.dataset);
  
      let current_coordinates = {
        'latitude': 34.3938,
        'longitude': 108.846
       }
     
      console.log('current_coordinates',current_coordinates);

        var map = window.map = new AMap.Map('map', {
            zoom: 17,
            center: [current_coordinates['longitude'],current_coordinates['latitude']],
            pitch: 45,
            showLabel: false,
            mapStyle: 'amap://styles/blue',
            viewMode: '3D',
        });
    
        var loca = new Loca.Container({
          map,
      });
   
    
    
        // 绿色普通点
        var geo = new Loca.GeoJSONSource({
            url: 'http://localhost:5001/generateHealthJson?customerId={{ customerId }}',
        });

        var scatter = new Loca.ScatterLayer({
            zIndex: 111,
            opacity: 1,
            visible: true,
            zooms: [2, 22],
        });
        scatter.setSource(geo);
        scatter.setStyle({
            color: 'rgba(43,156,75,1)',
            unit: 'meter',
            size: [20, 20],
            borderWidth: 0,
        });
        loca.add(scatter);

        var breathGreen = new Loca.ScatterLayer({
          loca,
          zIndex: 113,
          opacity: 1,
          visible: true,
          zooms: [2, 22],
      });

      breathGreen.setSource(geo);
      breathGreen.setStyle({
          unit: 'meter',
          size: [60, 60],
          borderWidth: 0,
          texture: 'https://a.amap.com/Loca/static/loca-v2/demos/images/breath_green.png',
          //texture: 'http://localhost:5001/static/images/profile-header.png',
          duration: 500,
          animate: true,
      });
      
      // 添加到地图中
      loca.add(breathGreen);
    
      // 创建红色呼吸点图层
      var breathRed = new Loca.ScatterLayer({
          loca,
          zIndex: 113,
          opacity: 1,
          visible: true,
          zooms: [2, 22],
      });
      console.log('Health data:',geoLevelF);
      
      breathRed.setSource(geoLevelF);
      breathRed.setStyle({
          unit: 'meter',
          size: [60, 60],
          borderWidth: 0,
          texture: 'https://a.amap.com/Loca/static/loca-v2/demos/images/breath_red.png',
          duration: 500,
          animate: true,
      });
      
      // 添加到地图中
      loca.add(breathRed);
      
      // 添加点击事件弹出信息框
      map.on('click', async (e) => {
        // 获取点击的像素点
        const pixel = e.pixel.toArray();
        console.log('Map clicked at:', pixel);
    
        // 查询点击位置的特征
        const feature = breathRed.queryFeature(pixel);
        console.log('Clicked feature:', feature.properties);
    
        // 检查 feature 是否存在及其是否包含 coordinates
        if (feature && feature.coordinates) {
            const coordinates = feature.coordinates; // 直接获取坐标
            console.log('coordinates',coordinates);
            map.setCenter([coordinates[0],coordinates[1]]);
            console.log('coordinates',coordinates);
            const {deviceSn, alertType, timestamp, userName ,severityLevel} = feature.properties; // 提取属性
          
            //document.querySelector('#emergency-message').textContent = `${userName} 触发 ${alertType} 告警，请及时处理`;

          try {
              const address =  await reverseGeocode(coordinates[0], coordinates[1]);
              console.log('address',address);
                //console.log('Feature coordinates:', coordinates);
        
                // 将坐标转换为 AMap.LngLat 对象
                const lngLatObj = new AMap.LngLat(coordinates[0], coordinates[1]);
        
                // 创建信息框内容
                const content = ` 
              <div class="flex-row-fe">
              <div class="vector-alert"></div>
              <div class="vector-1-alert">
              <div style="position: relative; background: transparent; border: none; color: #db1f2c; font-size: 16px; cursor: pointer;" id="redCloseBtn">✖</div>
          
                <div class="mask-group-alert">
                  <div class="occurred-time">
                    <span class="occurred-time-2">发生时间：</span
                    ><span class="occurred-time-3">${timestamp}</span>
                  </div>
                  <div class="occurred-location">
                    <span class="occurred-location-4">发生地点：</span
                    ><span class="mou-mou-street">${address}</span>
                  </div>
                  <div class="occurred-location">
                    <span class="occurred-location-4">详情信息：</span>
                    <span class="details-info-8"> </span>
                    <span class="emergency-response-9">${userName} 触发  ${alertType} 告警，请及时处理</span>
                  </div>
                  <div class="group-a-alert"><div class="subtract"></div></div>
                  <span class="level-one-response">I级警告</span>
                </div>
              </div>
              <div class="vector-b"></div>
              <div class="fill-alert"></div>
            </div>
              `;
            //console.log('content',content);
          
    
            // 创建信息框并显示
            const infoWindow = new AMap.InfoWindow({
                content: content,
                offset: new AMap.Pixel(0, -20), // 调整偏移以显示在点上方
                isCustom: true, // 自定义样式
                enableClicking: true, 
            });
            infoWindow.open(map, lngLatObj); // 在地图上打开信息框
            setTimeout(() => {
              const closeButton = document.getElementById('redCloseBtn');
              console.log('closeButton',closeButton);
              if (closeButton) {
                closeButton.removeEventListener('click', handleClose); // 移除旧的事件监听器
        
                  closeButton.addEventListener('click', () => {
                    console.log('closeButton clicked');
                      infoWindow.close(); // 关闭 InfoWindow
                  });
              }
          }, 100);
        } catch (error) {
          console.error('Error fetching address:', error);
        }
        } else {
            console.warn("No valid feature found or coordinates are undefined.");
        }
    });
        // 黄色呼吸点
        var geoLevelE = new Loca.GeoJSONSource({
            //url: 'http://localhost:5001/static/data/warning.json',
            url: "http://localhost:5001/generateAlertJson?customerId={{ customerId }}&severityLevel=High ",
        });
        var breathYellow = new Loca.ScatterLayer({
            loca,
            zIndex: 112,
            opacity: 1,
            visible: true,
            zooms: [2, 22],
        });
        breathYellow.setSource(geoLevelE);
        breathYellow.setStyle({
            unit: 'meter',
            size: [50, 50],
            borderWidth: 0,
            texture: 'https://a.amap.com/Loca/static/loca-v2/demos/images/breath_yellow.png',
            duration: 1000,
            animate: true,
        });
        loca.add(breathYellow);
    
        console.log("BreathRed GeoJSON data:", breathRed);
        console.log("GeoJSON data for BreathRed:", geoLevelF);
   
        console.log("Map center:", map.getCenter());
    
    
        // 启动渲染动画
        loca.animate.start();
    
        // 添加点击事件，显示信息框
        var infoWindow = new AMap.InfoWindow({
            offset: new AMap.Pixel(0, -30),
        });
    
    
    
        var dat = new Loca.Dat();
        dat.addLayer(breathGreen, '绿色');
        dat.addLayer(breathRed, '红色');
        dat.addLayer(breathYellow, '黄色');

  // Function to fetch weather data


  // Add click event for yellow breathing points
  map.on('click', async (e) => {
  const pixel = e.pixel.toArray();
  const feature = breathYellow.queryFeature(pixel);

  if (feature && feature.coordinates) {
    const coordinates = feature.coordinates;
    map.setCenter([coordinates[0],coordinates[1]]);
    const { deviceSn, alertType, timestamp, userName ,severityLevel} = feature.properties;
    document.querySelector('#warning-message').textContent = `${userName} 触发 ${alertType} 告警，请及时处理`;
    const address =  await reverseGeocode(coordinates[0], coordinates[1]);

    const lngLatObj = new AMap.LngLat(coordinates[0], coordinates[1]);
    const content = `
          <div class="flex-row-fe">
              <div class="vector-alert"></div>
              <div class="vector-1-alert">
              <div style="position: relative; background: transparent; border: none; color: #eaea0f; font-size: 16px; cursor: pointer;" id="yellowCloseBtn">✖</div>
          
                <div class="mask-group-alert">
                  <div class="occurred-time">
                    <span class="occurred-time-warning">发生时间：</span
                    ><span class="occurred-time-warning">${timestamp}</span>
                  </div>
                  <div class="occurred-location">
                    <span class="occurred-location-warning">发生地点：</span
                    ><span class="mou-mou-street">${address}</span>
                  </div>
                  <div class="occurred-location">
                    <span class="occurred-location-warning">详情信息：</span>
                    <span class="details-info-warning"> </span>
                    <span class="emergency-response-9">${userName} 触发 ${alertType} 告警，请及时处理</span>
                  </div>
                  <div class="group-a-alert"><div class="subtract"></div></div>
                  <span class="level-two-response">II级警告</span>
                </div>
              </div>
              <div class="vector-b"></div>
              <div class="fill-alert"></div>
            </div>
    `;

    const infoWindow = new AMap.InfoWindow({
      content: content,
      offset: new AMap.Pixel(0, -20),
      isCustom: true,
      enableClicking: true, 
    });
    infoWindow.open(map, lngLatObj);
    setTimeout(() => {
      const closeButton = document.getElementById('yellowCloseBtn');
      if (closeButton) {
        closeButton.addEventListener('click', () => {
          infoWindow.close();
        });
      }
    }, 100);
  }
  });

  // Add click event for green breathing points
  map.on('click', (e) => {
  const pixel = e.pixel.toArray();
  const feature = breathGreen.queryFeature(pixel);

  if (feature && feature.coordinates) {
    const coordinates = feature.coordinates;
    map.setCenter([coordinates[0],coordinates[1]]);
    const { deviceSn, heartRate, pressureHigh, pressureLow, bloodOxygen, temperature, userName, phoneNumber } = feature.properties;

    const lngLatObj = new AMap.LngLat(coordinates[0], coordinates[1]);


    const content = `
      <div class="vector-a5">
        <div class="mask-group-a6">
          <div style="position: relative; background: transparent; border: none; color: #f4e64f; font-size: 16px; cursor: pointer;" id="greenCloseBtn">✖</div>
          <div class="license-plate-zhe-c">
            <span class="license-plate">员工：</span><a href="http://localhost:5001/personal?deviceSn=${deviceSn}" target="_blank" class="text-1b">${userName}</a>
          </div>
          <div class="driver-chen-zhonghua">
            <span class="driver">心率：</span><span class="chen-zhonghua">${heartRate}</span>
          </div>
          <div class="contact-information">
            <span class="contact">血氧：</span><span class="text-1f">${bloodOxygen}</span>
          </div>
          <div class="current-speed-km-per-hour">
            <span class="current-speed">体温：</span><span class="text-23">${temperature}</span>
          </div>
          <div class="vehicle-type-gps-number-fs-qg">
            <span class="vehicle-type-gps-number">血压：</span><span class="text-23">${pressureHigh}/${pressureLow}</span>
          </div>
        </div>
      </div>
    `;

    const infoWindow = new AMap.InfoWindow({
      content: content,
      offset: new AMap.Pixel(0, -20),
      isCustom: true,
    });
    infoWindow.open(map, lngLatObj);
    setTimeout(() => {
      const closeButton = document.getElementById('greenCloseBtn');
      if (closeButton) {
        closeButton.addEventListener('click', () => {
          infoWindow.close();
        });
      }
    }, 0);
  }
  });
}

initializeMap();


</script>
<script>
  async function fetchWeather() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(async (position) => {
        const { latitude, longitude } = position.coords;
        console.log('latitude',latitude);
        console.log('longitude',longitude);
        
        try {
          // Reverse geocode to get the city-level administrative code
          const geocodeResponse = await fetch(`https://restapi.amap.com/v3/geocode/regeo?key=d45f28e481665db5b1145a5aa989e68a&location=${longitude},${latitude}`);
          const geocodeData = await geocodeResponse.json();
          
          if (geocodeData.status === '1') {
            const city = geocodeData.regeocode.addressComponent.city || geocodeData.regeocode.addressComponent.province;
            const cityCode = geocodeData.regeocode.addressComponent.adcode;
    
            console.log('city',city);
            console.log('cityCode',cityCode);
            
            // Fetch weather data using the city code
            const weatherResponse = await fetch(`https://restapi.amap.com/v3/weather/weatherInfo?key=d45f28e481665db5b1145a5aa989e68a&city=${cityCode}`);
            const weatherData = await weatherResponse.json();
            
            if (weatherData.status === '1') {
              const weather = weatherData.lives[0].weather;
              const temperature = weatherData.lives[0].temperature;
              document.querySelector('.weather').textContent = `天气：${weather}，温度：${temperature}°C`;
            } else {
              console.error('Failed to fetch weather data:', weatherData.info);
            }
          } else {
            console.error('Failed to fetch geocode data:', geocodeData.info);
          }
        } catch (error) {
          console.error('Error fetching data:', error);
        }
      }, (error) => {
        console.error('Error getting location:', error);
      });
    } else {
      console.error('Geolocation is not supported by this browser.');
    }
    }
    
    // Call the function to fetch weather data
    fetchWeather();
    
    function updateTimeAndDate() {
    const timeElement = document.querySelector('.time');
    const dateElement = document.querySelector('.date');
    const now = new Date();
    
    // Update time
    const formattedTime = now.toLocaleTimeString('en-GB', { hour12: false });
    timeElement.textContent = formattedTime;
    
    // Update date
    const formattedDate = now.toISOString().split('T')[0]; // Format as YYYY-MM-DD
    dateElement.textContent = formattedDate;
    }
    
    // Update the time and date every second
    setInterval(updateTimeAndDate, 1000);
    
    // Initialize the time and date immediately
    updateTimeAndDate();
    
    function closeInfoWindow() {
    if (infoWindow) {
        infoWindow.close();
    }
    }
  function updateDay() {
    const dayElement = document.querySelector('.day');
    const daysOfWeek = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
    const now = new Date();
    const currentDay = daysOfWeek[now.getDay()];
    dayElement.textContent = currentDay;
  }

  // Call the function to update the day
  updateDay();
</script>
<script>
function handleClose() {
    console.log('closeButton clicked');
    infoWindow.close();
}
</script>
<script>
  async function fetchAndDisplayAlerts() {
    try {
      const response = await fetch('/fetch_alerts');
      const data = await response.json();

      if (data.success) {
        const alertsContainer = document.getElementById('alerts-container');
        alertsContainer.innerHTML = ''; // Clear existing alerts

        // Update total alerts and unique alert types
        const totalAlertsElement = document.getElementById('total-alerts');
        const uniqueAlertTypesElement = document.getElementById('unique-alert-types');

        if (totalAlertsElement) {
          totalAlertsElement.textContent = data.totalAlerts;
        }

        if (uniqueAlertTypesElement) {
          uniqueAlertTypesElement.textContent = data.uniqueAlertTypes;
        }

        // Display each alert
        data.alerts.forEach(alert => {
          const alertDiv = document.createElement('div');
          alertDiv.className = 'rectangle-22c';
          alertDiv.innerHTML = `
            <span class="wz">${alert.userName}</span>
            <span class="toiletries-basin-toothbrush">${alert.alertType}</span>
            <span class="set-3255">${alert.timestamp}</span>
          `;
          alertsContainer.appendChild(alertDiv);
        });
      } else {
        console.error('Failed to fetch alerts:', data.error);
      }
    } catch (error) {
      console.error('Error fetching alerts:', error);
    }
  }

  // Call the function to fetch and display alerts
  fetchAndDisplayAlerts();
</script>
<script>
  async function reverseGeocode(lng, lat) {
    try {
        const response = await fetch(`https://restapi.amap.com/v3/geocode/regeo?key=d45f28e481665db5b1145a5aa989e68a&location=${lng},${lat}`);
        const data = await response.json();
        
        if (data.status === '1') {
            const address = data.regeocode.formatted_address;
            console.log('Address:', address);
            return address;
        } else {
            console.error('Failed to reverse geocode:', data.info);
            return null;
        }
    } catch (error) {
        console.error('Error during reverse geocoding:', error);
        return null;
    }
}
</script>
  </body>
</html>
